---
title: "Finding Emergency Sanitary Pad Stations in City Corners (寻找城市角落的紧急卫生巾站)"
author: "Group 1"
date: "`r Sys.Date()`"
format:
    bookup-html:
        toc: true
        toc-depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


<style>
/* Base styles for sidebar */
#sidebarleft {
  position: fixed;
  top: 0;
  left: 0;
  width: 25%; /* Use percentage for responsive sizing */
  height: 100vh;
  background-color: grey;
  background-image: url('girl.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  z-index: 1000;
}

/* Ensure that content does not overlap with the sidebar */
#quarto-content {
  margin-left: calc(20% + 1rem); /* Use calc to dynamically calculate margin */
}

/* Adjust sidebar and content on smaller screens */
@media (max-width: 1024px) {
  #sidebarleft {
    width: 20%;
  }
  #quarto-content {
    margin-left: calc(20% + 1rem);
  }
}

@media (max-width: 768px) {
  #sidebarleft {
    width: 25%;
  }
  #quarto-content {
    margin-left: calc(25% + 1rem);
  }
  
}

@media (max-width: 480px) {
  #sidebarleft {
    width: 35%;
  }
  #quarto-content {
    margin-left: calc(35% + 1rem);
  }
}

.sidebar.toc-left, .sidebar.margin-sidebar {
  position: fixed;
  top: 0;
  right: 0;
  width: 10vw;
  max-width: 300px;
  height: 100vh;
  overflow-y: auto;
  z-index: 1050;
}

.content {
  margin-right: 1rem; /* Add some space on the right */
}

/* Additional styles to ensure no overlap */
#quarto-content.page-columns #quarto-margin-sidebar, #quarto-content.page-columns #quarto-sidebar {
    grid-column-start: 3;
}

.sidebar.toc-left, .sidebar.margin-sidebar {
  margin-left: 26px; /* Adjust if necessary */
}
  

</style>


<div id="sidebarleft"></div>

########### Contents

# Interactive plot

<iframe src="/Users/tonygong/Projects-mac/INFO5000Coursework/plot.html" width="100%" height="400"></iframe>

# Introduction
## Background and Purpose
Introduce the necessity of emergency sanitary pad stations in urban areas, referencing the importance of accessibility and public health.

## Scope of the Study
Define the geographical and demographic scope of your research. （可提及主要的两个部分，一个是可视化，一个是小程序那里under development的那个设备，太阳能那个，提第二点时提我们有算一些东西）

# Methodology

## Data Collection
Outline the methods used to gather data on sanitary pad dispensers, including any surveys, field studies, or database analyses.

## Interactive Plot Explanation
Describe how the interactive plot was developed and how it visualizes the data.

# Analysis of Current Situation
## Distribution of Dispensers
Present findings on the number and locations of sanitary pad dispensers across different districts.

## Accessibility and Visibility
Assess how accessible and visible these stations are to the public.

# Comparative Study
## Benchmarking
Compare the availability of sanitary pad dispensers in your study area with other cities or standards, if applicable.

## Lessons from Previous Studies
Reference the "育婴室" (baby care rooms) study as a benchmark or point of comparison.

# Interactive Plot Section
## Data Visualization
Present the interactive plot showing the distribution of sanitary pad dispensers.

## Interpretation of Data

```{r}
# Load necessary libraries
library(dplyr)
library(scales)

# Create data frame
data <- data.frame(
  quantity = c(3, 1, 17, 10, NA, 18, 7, NA, 28, 4, 17, 9, 5, 23, 7, 5, 3, 6, NA, NA, 6, NA, NA, 35, 6, 3, 6, 5, NA),
  distance_to_metro = c(126, 159, 274, 814, 1700, 574, 110, 109, 435, 473, 1300, 1200, 1600, 1500, 1000, 1200, 697, 798, 1000, 767, 876, 766, 488, 2000, 1200, 3000, 386, 273, 860),
  score = 1:29
)

# Min-Max Normalization
df_minmax <- as.data.frame(lapply(data, function(x) ifelse(is.na(x), NA, rescale(x))))

# Standardization (Z-score normalization)
df_standardized <- as.data.frame(scale(data))

# Log Transformation - Handling NA values
df_log <- data
df_log$quantity <- ifelse(is.na(df_log$quantity), NA, log(df_log$quantity + 1))
df_log$distance_to_metro <- ifelse(is.na(df_log$distance_to_metro), NA, log(df_log$distance_to_metro + 1))


library(openxlsx)

# Create a new workbook
wb <- createWorkbook()

# Add sheets and write data to each sheet
addWorksheet(wb, "Min-Max Normalization")
writeData(wb, sheet = "Min-Max Normalization", df_minmax)

addWorksheet(wb, "Standardization")
writeData(wb, sheet = "Standardization", df_standardized)

addWorksheet(wb, "Log Transformation")
writeData(wb, sheet = "Log Transformation", df_log)

# Save the workbook as an Excel file
saveWorkbook(wb, "NormalizedData.xlsx", overwrite = TRUE)
```



Provide insights and trends identified from the interactive plot.







# Challenges and Limitations
## Identify Challenges
Discuss any challenges faced in locating and assessing the sanitary pad stations.

## Study Limitations
Address any limitations of your research methods or data.

# Recommendations and Future Work
## Improving Accessibility
Suggest ways to increase the accessibility and number of sanitary pad stations.

## Policy Recommendations
Propose policy or public health recommendations based on your findings.

# Conclusion
## Summary of Findings
Concisely recap the key findings and insights from your study.

## Closing Remarks
Reflect on the importance of sanitary pad accessibility in urban areas.

# References
List of Sources: Include all the references and data sources used in your study.


